(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     29228,        750]
NotebookOptionsPosition[     26774,        702]
NotebookOutlinePosition[     27173,        718]
CellTagsIndexPosition[     27130,        715]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Zero-Noise Extrapolation (ZNE) Interactive Demo", "Title",ExpressionUUID->"609a0ba4-beb0-6542-a062-05109fa43e4b"],

Cell["\<\
An end-to-end demonstrator for ZNE error mitigation.
Inspired by Temme, Bravyi & Gambetta (arXiv:1612.02058).
Built with Mathematica 14.3 and Wolfram QuantumFramework.\
\>", "Subtitle",ExpressionUUID->"91c01fe0-ec96-3a40-a40c-24e9c62a68f8"],

Cell[CellGroupData[{

Cell["References", "Section",ExpressionUUID->"69a4bfd8-df7c-7246-985a-658f8f1984d1"],

Cell["\<\
1. Temme, Bravyi, Gambetta \[Dash] \"Error Mitigation for Short-Depth Quantum \
Circuits\" (arXiv:1612.02058)
   https://arxiv.org/pdf/1612.02058

2. Kandala et al. \[Dash] \"Error mitigation extends the computational \
reach...\" (arXiv:1805.04492)
   https://arxiv.org/abs/1805.04492\
\>", "Text",ExpressionUUID->"6843ca6d-c674-854c-99dd-fefb1bfc4f99"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Environment", "Section",ExpressionUUID->"d7455bf2-01ad-cb4d-81db-08e151d00bf4"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Mathematica Version: \>\"", ",", "$VersionNumber"}], 
  "]"}]], "Input",ExpressionUUID->"a5a36eae-8b3f-b046-bb94-43e23bc863d9"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<System: \>\"", ",", "$SystemID"}], "]"}]], "Input",ExpressionUU\
ID->"71ad5a60-ffc7-8f49-967c-325c0ae94630"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<QuantumFramework: \>\"", ",", 
   RowBox[{"PacletFind", "[", "\"\<Wolfram/QuantumFramework\>\"", "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"2fc07c35-7672-6641-8d40-f462aba95f86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load ZNE Package", "Section",ExpressionUUID->"74f1cff4-8070-e241-b76a-a9d72f232395"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", 
      ",", "\"\<src\>\"", ",", "\"\<ZNEDemo.wl\>\""}], "}"}], "]"}], "]"}], ";", 
  RowBox[{"Print", "[", "\"\<ZNE package loaded.\>\"", "]"}]}]], "Input",Expre\
ssionUUID->"7d471f5e-b0ef-7c40-899d-9cb9abf2ebb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interactive ZNE Demo", "Section",ExpressionUUID->"917d81b8-513a-6941-816d-51e94fe9d74a"],

Cell["\<\
Use the controls below to explore how ZNE mitigates depolarizing noise on a \
Ry(\[Theta]) circuit.

Three plots are shown:
  1. Main: Ideal vs Noisy vs ZNE expectation curves
  2. Error: Absolute error of Noisy and ZNE vs Ideal
  3. Fit: Local polynomial extrapolation at the probe angle\
\>", "Text",ExpressionUUID->"3391b69f-fe86-e240-8cd5-b7384a4a6c6c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\n", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sweepResult", ",", " ", "idealPts", ",", " ", "znePts", ",", " ", 
       "mainPlot", ",", " ", "errorPlot", ",", " ", "noisyErrors", ",", " ", 
       "zneErrors", ",", " ", "fitPlot", ",", " ", "fitData", ",", " ", 
       "fitLambdas", ",", " ", "fitMeans", ",", " ", "polyOrder2", ",", " ", 
       "fit", ",", " ", "lam", ",", " ", "extrapolated"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"sweepResult", "=", 
       RowBox[{"ZNE`GenerateSweep", "[", "\n", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", " ", "Pi"}], ",", 
            RowBox[{"2", " ", 
             RowBox[{"Pi", "/", "nPts"}]}]}], "]"}], "]"}], ",", "lambdaList",
          ",", "polyOrd", ",", "\n", 
         RowBox[{"\"\<NoiseModel\>\"", "->", "noiseModel"}], ",", 
         RowBox[{"\"\<BaseNoise\>\"", "->", "p0"}], ",", 
         RowBox[{"\"\<Shots\>\"", "->", "Infinity"}]}], "]"}]}], ";", "\n", 
      RowBox[{"idealPts", "=", 
       RowBox[{"sweepResult", "[", "\"\<IdealData\>\"", "]"}]}], ";", 
      RowBox[{"znePts", "=", 
       RowBox[{"sweepResult", "[", "\"\<ZNEData\>\"", "]"}]}], ";", "\n", 
      RowBox[{"mainPlot", "=", 
       RowBox[{"Show", "[", "\n", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Values", "[", 
              RowBox[{"sweepResult", "[", "\"\<NoisyData\>\"", "]"}], "]"}], ",",
              "idealPts"}], "]"}], ",", "\n", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"\"\<\[Lambda]=\>\"", "<>", 
                 RowBox[{"ToString", "[", "l", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "lambdaList"}], "}"}]}], "]"}], 
              ",", "\"\<Ideal\>\""}], "]"}]}], ",", "\n", 
           RowBox[{
           "PlotLabel", "->", "\"\<ZNE: Expectation vs \[Theta]\>\""}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             
             RowBox[{"\"\<\[Theta]\>\"", 
              ",", "\"\<\[LeftAngleBracket]Z\[RightAngleBracket]\>\""}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "600"}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Black"}], "}"}], ",", "Automatic"}], 
             "}"}]}]}], "]"}], ",", "\n", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{"znePts", ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", "\"\<ZNE\>\"", "}"}]}]}], "]"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"noisyErrors", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ideal", ",", "noisy"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ideal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"noisy", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"ideal", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ",",
          "\n", 
         RowBox[{"{", 
          RowBox[{"idealPts", ",", 
           RowBox[{"sweepResult", "[", 
            RowBox[{"\"\<NoisyData\>\"", ",", 
             RowBox[{"First", "[", "lambdaList", "]"}]}], "]"}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"zneErrors", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ideal", ",", "zne"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ideal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"zne", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"ideal", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"idealPts", ",", "znePts"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"errorPlot", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"noisyErrors", ",", "zneErrors"}], "}"}], ",", "\n", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Noisy (\[Lambda]=1)\>\"", ",", "\"\<ZNE\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<Absolute Error vs \[Theta]\>\""}], ",", 
         RowBox[{"AxesLabel", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<|Error|\>\""}], "}"}]}], ",", 
         RowBox[{"ImageSize", "->", "600"}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Orange"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], "}"}]}]}],
         "]"}]}], ";", "\n", 
      RowBox[{"fitLambdas", "=", 
       RowBox[{"N", "[", "lambdaList", "]"}]}], ";", 
      RowBox[{"fitMeans", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ZNE`NoisyExpectation", "[", 
          RowBox[{"thetaProbe", ",", "l", ",", 
           RowBox[{"\"\<NoiseModel\>\"", "->", "noiseModel"}], ",", 
           RowBox[{"\"\<BaseNoise\>\"", "->", "p0"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "fitLambdas"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"fitData", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"fitLambdas", ",", "fitMeans"}], "}"}], "]"}]}], ";", 
      RowBox[{"polyOrder2", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"polyOrd", ",", 
         RowBox[{
          RowBox[{"Length", "[", "fitLambdas", "]"}], "-", "1"}]}], "]"}]}], ";", 
      RowBox[{"fit", "=", 
       RowBox[{"Fit", "[", 
        RowBox[{"fitData", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"lam", "^", "k"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "polyOrder2"}], "}"}]}], "]"}], ",", 
         "lam"}], "]"}]}], ";", 
      RowBox[{"extrapolated", "=", 
       RowBox[{"fit", "/.", 
        RowBox[{"lam", "->", "0"}]}]}], ";", "\n", 
      RowBox[{"fitPlot", "=", 
       RowBox[{"Show", "[", "\n", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"fitData", ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"PointSize", "[", "0.02", "]"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "->", 
            RowBox[{"\"\<Local Fit at \[Theta]=\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"thetaProbe", ",", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<E(\[Lambda])\>\""}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", "\n", 
         RowBox[{"Plot", "[", 
          RowBox[{"fit", ",", 
           RowBox[{"{", 
            RowBox[{"lam", ",", "0", ",", 
             RowBox[{"Max", "[", "fitLambdas", "]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Dashed"}], "}"}]}]}], "]"}], ",", "\n", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "extrapolated"}], "}"}], "}"}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}]}]}], "]"}], ",",
          "\n", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<ZNE = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"extrapolated", ",", "4"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "extrapolated"}], "}"}]}], "]"}], "}"}]}]}],
         "]"}]}], ";", "\n", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mainPlot", ",", "errorPlot", ",", "fitPlot"}], "}"}], ",", 
        RowBox[{"Spacings", "->", "2"}]}], "]"}]}]}], "]"}], ",", "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p0", ",", "0.02", ",", "\"\<Base Noise\>\""}], "}"}], ",", "0",
      ",", "0.1", ",", "0.005"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "noiseModel", ",", "\"\<DepolarizingEnd\>\"", 
       ",", "\"\<Noise Model\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<DepolarizingEnd\>\"", ",", "\"\<DepolarizingPerGate\>\""}],
       "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lambdaList", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
       ",", "\"\<\[Lambda] List\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
        "->", "\"\<{1,2,3,4}\>\""}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1.5", ",", "2", ",", "2.5", ",", "3"}], "}"}], 
        "->", "\"\<{1,1.5,2,2.5,3}\>\""}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"polyOrd", ",", "2", ",", "\"\<Poly Order\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nPts", ",", "30", ",", "\"\<Theta Points\>\""}], "}"}], ",", 
     "10", ",", "80", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"thetaProbe", ",", "1.0", ",", "\"\<Probe \[Theta]\>\""}], 
      "}"}], ",", "0.1", ",", "6.0", ",", "0.1"}], "}"}]}], "]"}]], "Input",Ex\
pressionUUID->"f471a8e7-1193-a040-96f9-7c9d725897a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Validation Checks", "Section",ExpressionUUID->"66508974-55c6-0f49-a379-a76df9245701"],

Cell["Automated pass/fail acceptance checks.", "Text",ExpressionUUID->"174f8a7e-a1a7-2a42-a751-1fc49186f757"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"thetaTest", ",", " ", "lambdas"}], "}"}], ",", "\n", 
   RowBox[{
    RowBox[{"thetaTest", "=", 
     RowBox[{"N", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"0.1", ",", 
        RowBox[{"2", " ", "Pi"}], ",", "0.3"}], "]"}], "]"}]}], ";", 
    RowBox[{"lambdas", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";", "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sweep", ",", "maxErr"}], "}"}], ",", 
      RowBox[{
       RowBox[{"sweep", "=", 
        RowBox[{"ZNE`GenerateSweep", "[", 
         RowBox[{"thetaTest", ",", "lambdas", ",", "2", ",", 
          RowBox[{"\"\<BaseNoise\>\"", "->", "0.001"}]}], "]"}]}], ";", 
       RowBox[{"maxErr", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<ZNEData\>\"", ",", "All", ",", "2"}], "]"}], "-", 
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<IdealData\>\"", ",", "All", ",", "2"}], "]"}]}], 
          "]"}], "]"}]}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Check 1 (low noise): max|ZNE-Ideal| = \>\"", ",", 
         "maxErr", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"maxErr", "<", "0.01"}], ",", "\"\< PASS\>\"", 
           ",", "\"\< FAIL\>\""}], "]"}]}], "]"}]}]}], "]"}], ";", "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sweep", ",", "noisyErr", ",", "zneErr", ",", "improvement"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"sweep", "=", 
        RowBox[{"ZNE`GenerateSweep", "[", 
         RowBox[{"thetaTest", ",", "lambdas", ",", "2", ",", 
          RowBox[{"\"\<BaseNoise\>\"", "->", "0.05"}]}], "]"}]}], ";", 
       RowBox[{"noisyErr", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<NoisyData\>\"", ",", "1", ",", "All", ",", "2"}], 
            "]"}], "-", 
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<IdealData\>\"", ",", "All", ",", "2"}], "]"}]}], 
          "]"}], "]"}]}], ";", 
       RowBox[{"zneErr", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<ZNEData\>\"", ",", "All", ",", "2"}], "]"}], "-", 
           RowBox[{"sweep", "[", 
            RowBox[{"\"\<IdealData\>\"", ",", "All", ",", "2"}], "]"}]}], 
          "]"}], "]"}]}], ";", 
       RowBox[{"improvement", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"noisyErr", "-", "zneErr"}], ")"}], "/", "noisyErr"}]}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Check 2: Noisy MAE=\>\"", ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"noisyErr", ",", "4"}], "]"}], ",", "\"\< | ZNE MAE=\>\"", ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"zneErr", ",", "4"}], "]"}], ",", "\"\< | \>\"", ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"100", " ", "improvement"}], ",", "3"}], "]"}], 
         ",", "\"\<%\>\"", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zneErr", "<", "noisyErr"}], ",", "\"\< PASS\>\"", 
           ",", "\"\< FAIL\>\""}], "]"}]}], "]"}]}]}], "]"}], ";", "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sweepE", ",", "sweepP", ",", "endErr", ",", "pgErr"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"sweepE", "=", 
        RowBox[{"ZNE`GenerateSweep", "[", 
         RowBox[{"thetaTest", ",", "lambdas", ",", "2", ",", 
          RowBox[{"\"\<NoiseModel\>\"", "->", "\"\<DepolarizingEnd\>\""}], ",", 
          RowBox[{"\"\<BaseNoise\>\"", "->", "0.03"}]}], "]"}]}], ";", 
       RowBox[{"sweepP", "=", 
        RowBox[{"ZNE`GenerateSweep", "[", 
         RowBox[{"thetaTest", ",", "lambdas", ",", "2", ",", 
          RowBox[{"\"\<NoiseModel\>\"", "->", "\"\<DepolarizingPerGate\>\""}],
           ",", 
          RowBox[{"\"\<BaseNoise\>\"", "->", "0.03"}]}], "]"}]}], ";", 
       RowBox[{"endErr", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"sweepE", "[", 
            RowBox[{"\"\<NoisyData\>\"", ",", "1", ",", "All", ",", "2"}], 
            "]"}], "-", 
           RowBox[{"sweepE", "[", 
            RowBox[{"\"\<IdealData\>\"", ",", "All", ",", "2"}], "]"}]}], 
          "]"}], "]"}]}], ";", 
       RowBox[{"pgErr", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"sweepP", "[", 
            RowBox[{"\"\<NoisyData\>\"", ",", "1", ",", "All", ",", "2"}], 
            "]"}], "-", 
           RowBox[{"sweepP", "[", 
            RowBox[{"\"\<IdealData\>\"", ",", "All", ",", "2"}], "]"}]}], 
          "]"}], "]"}]}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Check 3: End MAE=\>\"", ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"endErr", ",", "4"}], "]"}], ",", "\"\< | PerGate MAE=\>\"",
          ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"pgErr", ",", "4"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pgErr", ">", "endErr"}], ",", "\"\< PASS\>\"", 
           ",", "\"\< Equal (single gate)\>\""}], "]"}]}], "]"}]}]}], 
     "]"}]}]}], "]"}]], "Input",ExpressionUUID->"5b1f6138-1f21-8745-9a83-\
7634e647a3fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Artifacts", "Section",ExpressionUUID->"9aeadfa0-e460-2b41-940c-d64087398fff"],

Cell["Run the cell below to export figures and PDF.", "Text",ExpressionUUID->"89a581c8-5a49-504a-8d7f-03934b2635cf"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "exportDir", ",", " ", "figDir", ",", " ", "sweep", ",", " ", "mainFig", ",",
      " ", "errorFig"}], "}"}], ",", "\n", 
   RowBox[{
    RowBox[{"exportDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<exports\>\""}], 
       "}"}], "]"}]}], ";", 
    RowBox[{"figDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"exportDir", ",", "\"\<figures\>\""}], "}"}], "]"}]}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "figDir", "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"figDir", ",", 
        RowBox[{"CreateIntermediateDirectories", "->", "True"}]}], "]"}]}], 
     "]"}], ";", "\n", 
    RowBox[{"sweep", "=", 
     RowBox[{"ZNE`GenerateSweep", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", " ", "Pi"}], ",", 
          RowBox[{"2", " ", 
           RowBox[{"Pi", "/", "40"}]}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "2", ",", 
       RowBox[{"\"\<BaseNoise\>\"", "->", "0.03"}]}], "]"}]}], ";", "\n", 
    RowBox[{"mainFig", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Values", "[", 
            RowBox[{"sweep", "[", "\"\<NoisyData\>\"", "]"}], "]"}], ",", 
           RowBox[{"sweep", "[", "\"\<IdealData\>\"", "]"}]}], "]"}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\"\<\[Lambda]=\>\"", "<>", 
               RowBox[{"ToString", "[", "l", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
               "}"}]}], "]"}], ",", "\"\<Ideal\>\""}], "]"}]}], ",", 
         RowBox[{
         "PlotLabel", "->", "\"\<ZNE: Ideal vs Noisy vs Mitigated\>\""}], ",", 
         RowBox[{"ImageSize", "->", "700"}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black"}], "}"}], ",", "Automatic"}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"sweep", "[", "\"\<ZNEData\>\"", "]"}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", "\"\<ZNE\>\"", "}"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
    
    RowBox[{"errorFig", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"n", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sweep", "[", "\"\<IdealData\>\"", "]"}], ",", 
             RowBox[{"sweep", "[", 
              RowBox[{"\"\<NoisyData\>\"", ",", "1"}], "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "z"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"z", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sweep", "[", "\"\<IdealData\>\"", "]"}], ",", 
             RowBox[{"sweep", "[", "\"\<ZNEData\>\"", "]"}]}], "}"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Noisy (\[Lambda]=1)\>\"", ",", "\"\<ZNE\>\""}], "}"}]}],
        ",", 
       RowBox[{"PlotLabel", "->", "\"\<Absolute Error Comparison\>\""}], ",", 
       
       RowBox[{"ImageSize", "->", "700"}]}], "]"}]}], ";", "\n", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"figDir", ",", "\"\<zne_main_plot.png\>\""}], "}"}], "]"}], ",",
       "mainFig", ",", 
      RowBox[{"ImageResolution", "->", "150"}]}], "]"}], ";", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"figDir", ",", "\"\<zne_error_plot.png\>\""}], "}"}], "]"}], ",",
       "errorFig", ",", 
      RowBox[{"ImageResolution", "->", "150"}]}], "]"}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Figures exported to: \>\"", ",", "figDir"}], "]"}], ";", 
    "\n", 
    RowBox[{"NotebookPrint", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"exportDir", ",", "\"\<ZNE_Demo.pdf\>\""}], "}"}], "]"}]}], 
     "]"}], ";", 
    RowBox[{"Print", "[", "\"\<PDF exported.\>\"", "]"}]}]}], "]"}]], "Input",\
ExpressionUUID->"429df498-0b1f-654a-a453-866cd8d542b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproducibility Runbook", "Section",ExpressionUUID->"731e6e93-ee83-c84a-a924-d45b491dc741"],

Cell["\<\
Follow these steps to reproduce results on another machine:

1. Install Mathematica 14.3 (or compatible version).
2. Install the QuantumFramework paclet:
     PacletInstall[\"Wolfram/QuantumFramework\"]
3. Open this notebook (notebook/ZNE_Demo.nb) in Mathematica.
4. Evaluate All Cells (Evaluation menu).
5. Interactive demo appears in the ZNE Demo section.
6. Export artifacts by running the Export section.

Default parameters for exports:
  - BaseNoise: 0.03
  - NoiseModel: DepolarizingEnd
  - LambdaList: {1, 2, 3, 4}
  - Polynomial Order: 2
  - Theta points: 40
  - Shots: Infinity (analytic)\
\>", "Text",ExpressionUUID->"506bac32-02d0-8544-967f-7e83f62f68f6"]
}, Open  ]]
},
WindowSize->{1000, 750},
WindowMargins->{{100, Automatic}, {Automatic, 50}},
FrontEndVersion->"14.3 for Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55baad91-7142-f24c-9230-ecd087321f37"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 119, 0, 70, "Title",ExpressionUUID->"609a0ba4-beb0-6542-a062-05109fa43e4b"],
Cell[676, 22, 250, 4, 70, "Subtitle",ExpressionUUID->"91c01fe0-ec96-3a40-a40c-24e9c62a68f8"],
Cell[CellGroupData[{
Cell[951, 30, 84, 0, 70, "Section",ExpressionUUID->"69a4bfd8-df7c-7246-985a-658f8f1984d1"],
Cell[1038, 32, 364, 8, 70, "Text",ExpressionUUID->"6843ca6d-c674-854c-99dd-fefb1bfc4f99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1439, 45, 85, 0, 70, "Section",ExpressionUUID->"d7455bf2-01ad-cb4d-81db-08e151d00bf4"],
Cell[1527, 47, 180, 3, 70, "Input",ExpressionUUID->"a5a36eae-8b3f-b046-bb94-43e23bc863d9"],
Cell[1710, 52, 161, 3, 70, "Input",ExpressionUUID->"71ad5a60-ffc7-8f49-967c-325c0ae94630"],
Cell[1874, 57, 233, 4, 70, "Input",ExpressionUUID->"2fc07c35-7672-6641-8d40-f462aba95f86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2144, 66, 90, 0, 70, "Section",ExpressionUUID->"74f1cff4-8070-e241-b76a-a9d72f232395"],
Cell[2237, 68, 391, 9, 70, "Input",ExpressionUUID->"7d471f5e-b0ef-7c40-899d-9cb9abf2ebb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2665, 82, 94, 0, 70, "Section",ExpressionUUID->"917d81b8-513a-6941-816d-51e94fe9d74a"],
Cell[2762, 84, 367, 8, 70, "Text",ExpressionUUID->"3391b69f-fe86-e240-8cd5-b7384a4a6c6c"],
Cell[3132, 94, 10714, 269, 70, "Input",ExpressionUUID->"f471a8e7-1193-a040-96f9-7c9d725897a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13883, 368, 91, 0, 70, "Section",ExpressionUUID->"66508974-55c6-0f49-a379-a76df9245701"],
Cell[13977, 370, 109, 0, 70, "Text",ExpressionUUID->"174f8a7e-a1a7-2a42-a751-1fc49186f757"],
Cell[14089, 372, 5529, 135, 70, "Input",ExpressionUUID->"5b1f6138-1f21-8745-9a83-7634e647a3fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19655, 512, 90, 0, 70, "Section",ExpressionUUID->"9aeadfa0-e460-2b41-940c-d64087398fff"],
Cell[19748, 514, 116, 0, 70, "Text",ExpressionUUID->"89a581c8-5a49-504a-8d7f-03934b2635cf"],
Cell[19867, 516, 6077, 158, 70, "Input",ExpressionUUID->"429df498-0b1f-654a-a453-866cd8d542b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25981, 679, 97, 0, 70, "Section",ExpressionUUID->"731e6e93-ee83-c84a-a924-d45b491dc741"],
Cell[26081, 681, 677, 18, 70, "Text",ExpressionUUID->"506bac32-02d0-8544-967f-7e83f62f68f6"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
