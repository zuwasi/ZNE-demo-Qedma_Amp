# ZNE Validation Report

**Date:** 2026-02-11  
**Generated by:** `run_validation.wls` via WolframScript

---

## Parameter Settings

| Parameter | Value |
|-----------|-------|
| θ sweep (main plots) | 0 to 2π, 41 points (step = 2π/40) |
| θ sweep (validation checks) | 0.1 to 2π, step 0.3 |
| Scale factors (λ) | {1, 2, 3, 4} |
| Extrapolation order | 2 (quadratic Richardson) |
| Base noise (p₀) | 0.03 (main), 0.001 / 0.05 (checks) |
| Noise model | DepolarizingEnd (default) |
| Circuit | Single-qubit Rz(θ) with ⟨Z⟩ measurement |

---

## Numeric Summary (p₀ = 0.03, DepolarizingEnd)

| Metric | Value |
|--------|-------|
| Noisy (λ=1) MAE | 0.0127487 |
| ZNE MAE | 3.070 × 10⁻¹⁶ |
| Improvement | 99.99999999999758% |

---

## Validation Checks

| Check | Description | Result | Details |
|-------|-------------|--------|---------|
| **1** | Low-noise recovery (p₀ = 0.001) | **PASS** ✅ | max\|ZNE − Ideal\| = 1.11 × 10⁻¹⁵ (threshold < 0.01) |
| **2** | ZNE improvement over noisy (p₀ = 0.05) | **PASS** ✅ | Noisy MAE = 0.01275, ZNE MAE ≈ 3.07 × 10⁻¹⁶, improvement ≈ 100% |
| **3** | PerGate noise > End noise at same p₀ | **FAIL** ❌ | End MAE = 0.01275, PerGate MAE = 0.01275 (equal, not strictly greater) |

### Check 3 Analysis

Check 3 expected the per-gate depolarizing model to produce stronger cumulative noise than the end-of-circuit model at the same base error rate. Both models returned identical MAE values (0.01275), causing the strict inequality test (`pgErr > endErr`) to fail. This likely indicates that for a single-gate circuit (single Rz), there is no distinction between applying noise once at the end versus once per gate — they are mathematically equivalent when the circuit depth is 1.

---

## Interpretation

### Results

- **Checks 1 & 2 confirm the core ZNE algorithm is working correctly.** Richardson extrapolation with order 2 and scale factors {1, 2, 3, 4} recovers the ideal expectation value to machine precision (≈10⁻¹⁶) across the full θ sweep.
- The near-perfect recovery is expected for the analytic depolarizing noise model, where the expectation value scales as a known polynomial in the noise parameter — exactly the structure Richardson extrapolation is designed to invert.

### Known Limitations

1. **Variance amplification at high noise:** In real quantum hardware, ZNE with large scale factors (λ = 3, 4) amplifies statistical variance. The mitigated estimator's variance can grow as O(λ²ᵏ) for order-k extrapolation, requiring significantly more measurement shots to maintain the same confidence interval.

2. **Sampling overhead:** Each additional scale factor requires a separate set of circuit executions. With 4 scale factors, the total shot budget is ≈4× that of a single noisy execution, before accounting for the increased shots needed to combat variance amplification.

3. **Model mismatch:** The analytic noise model used here (exact depolarizing channel) is smoother and more predictable than real device noise. On hardware, gate-dependent coherent errors, crosstalk, and non-Markovian effects reduce the effectiveness of polynomial extrapolation.

4. **Check 3 (PerGate vs End):** For single-gate circuits, these models are degenerate. A multi-gate circuit (e.g., depth ≥ 3) would be needed to observe the expected separation where per-gate noise accumulates more aggressively.

---

## Exported Figures

The following figures were exported to `notebook/exports/figures/`:

| File | Description | Size |
|------|-------------|------|
| `zne_main_plot.png` | Ideal vs noisy (λ=1–4) vs ZNE-mitigated ⟨Z⟩ over θ | 118,897 bytes |
| `zne_error_plot.png` | Absolute error comparison: noisy (λ=1) vs ZNE | 80,370 bytes |

Both figures exported at 150 DPI, 700px image width.
